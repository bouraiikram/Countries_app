<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Liste des pays</title>
</head>
<body>

<h1>Liste des pays</h1>

<!-- Lien vers la page statistiques -->
<p>
    <a href="{% url 'stats' %}"> Voir les statistiques</a>
</p>

<hr>

<!-- FORMULAIRE DE FILTRES -->
<form method="get">
    <input
        type="text"
        name="search"
        placeholder="Rechercher un pays"
        value="{{ search }}"
    >

    <select name="region">
        <option value="">-- Toutes les régions --</option>
        {% for r in regions %}
            {% if r %}
                <option value="{{ r }}"
                    {% if selected_region == r %}selected{% endif %}>
                    {{ r }}
                </option>
            {% endif %}
        {% endfor %}
    </select>

    <button type="submit">Filtrer</button>
</form>

<hr>

<!-- LISTE DES PAYS -->
{% for c in countries %}
    <p>
        <a href="{% url 'country_detail' c.cca3 %}">
            {{ c.name }}
        </a>
    </p>
{% empty %}
    <p>Aucun pays trouvé.</p>
{% endfor %}

<hr>

<!-- PAGINATION -->
<div>
    {% if countries.has_previous %}
        <a href="?page={{ countries.previous_page_number }}{% if search %}&search={{ search }}{% endif %}{% if selected_region %}&region={{ selected_region }}{% endif %}">
            ◀ Précédent
        </a>
    {% endif %}

    <span>
        Page {{ countries.number }} / {{ countries.paginator.num_pages }}
    </span>

    {% if countries.has_next %}
        <a href="?page={{ countries.next_page_number }}{% if search %}&search={{ search }}{% endif %}{% if selected_region %}&region={{ selected_region }}{% endif %}">
            Suivant ▶
        </a>
    {% endif %}
</div>

</body>
</html>
